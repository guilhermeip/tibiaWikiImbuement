const item_imbuing = {
    "armor": {
        "itens": {
            "Albino Plate": {
                "value-option": "albino_plate",
                "image": "https://www.tibiawiki.com.br/images/9/98/Albino_Plate.gif"
            },
            "Amazon Armor": {
                "value-option": "amazon_armor",
                "image": "https://www.tibiawiki.com.br/wiki/Especial:Redirecionar/file/Amazon_Armor.gif"
            },
            "Blue Robe": {
                "value-option": "blue_robe",
                "image": ""
            },
            "Chain Armor": {
                "value-option": "chain_armor",
                "image": ""
            },
            "Crown Armor": {
                "value-option": "crown_armor"
            },
            "Demon Armor": {
                "value-option": "demon_armor"
            },
            "Depth Lorica": {
                "value-option": "depth_lorica"
            },
            "Dragon Scale Mail": {
                "value-option": "dragon_scale_mail"
            },
            "Dream Shroud": {
                "value-option": "dream_shroud"
            },
            "Dwarven Armor": {
                "value-option": "dwarven_armor"
            },
            "Elite Draken Mail": {
                "value-option": "elite_draken_mail"
            },
            "Elven Mail": {
                "value-option": "elven_mail"
            },
            "Falcon Plate": {
                "value-option": "falcon_plate"
            },
            "Gnome Armor": {
                "value-option": "gnome_armor"
            },
            "Golden Amor": {
                "value-option": "golden_armor"
            },
            "Heat Core": {
                "value-option": "heat_core"
            },
            "Heavy Metal T-Shirt": {
                "value-option": "heavy_metal_t-shirt"
            },
            "Knight Armor": {
                "value-option": "knight_armor"
            },
            "Leopard Armor": {
                "value-option": "leopard_armor"
            },
            "Living Armor": {
                "value-option": "living_armor"
            },
            "Magic Plate Armor": {
                "value-option": "magic_plate_armor"
            },
            "Mammoth Fur Cape": {
                "value-option": "mammoth_fur_cape"
            },
            "Master Archer's Armor": {
                "value-option": "master_archers_armor"
            },
            "Mooh'tah Plate": {
                "value-option": "moohtah_plate"
            },
            "Noble Armor": {
                "value-option": "noble_armor"
            },
            "Ornate Chestplate": {
                "value-option": "ornate_chestplate"
            },
            "Paladin Armor": {
                "value-option": "paladin_armor"
            },
            "Prismatic Armor": {
                "value-option": "prismatic_armor"
            },
        },
        "bonus": [
            {
                "image": "",
                "bonus-msg": "Life Leech",
                "bonus-percent-value": [5, 10, 25],
                "bonus-title": "Roubo de vida"
            },
            {
                "image": "",
                "bonus-msg": "Death reduction",
                "bonus-percent-value": [2, 5, 10],
                "bonus-title": "Redução dano Death"
            },
            {
                "image": "",
                "bonus-msg": "Earth reduction",
                "bonus-percent-value": [3, 8, 15],
                "bonus-title": "Redução dano Terra"
            },
            {
                "image": "",
                "bonus-msg": "Fire reduction",
                "bonus-percent-value": [3, 8, 15],
                "bonus-title": "Redução dano Fogo"
            },
            {
                "image": "",
                "bonus-msg": "Ice reduction",
                "bonus-percent-value": [3, 8, 15],
                "bonus-title": "Redução dano gelo"
            },
            {
                "image": "",
                "bonus-msg": "Energy reduction",
                "bonus-percent-value": [3, 8, 15],
                "bonus-title": "Redução dano energia"
            },
            {
                "image": "",
                "bonus-msg": "Holy reduction",
                "bonus-percent-value": [3, 8, 15],
                "bonus-title": "Redução dano sagrado"
            }
        ]
    },
    "backpack": {
        "itens": {
            "Anniversary Backpack": {
                "value-option": "anniversary_bp"
            },
            "Backpack": {
                "value-option": "bp"
            },
            "Backpack of Holding": {
                "value-option": "backpack_of_holding"
            },
            "Beach Backpack": {
                "value-option": "beach_bp"
            },
            "Birthday Backpack": {
                "value-option": "birthday_bp"
            },
            "Buggy Backpack": {
                "value-option": "buggy_bp"
            },
            "Book Backpack": {
                "value-option": "buggy_bp"
            },
            "Brocade Backpack": {
                "value-option": "brocade_bp"
            },
            "Camouflage Backpack": {
                "value-option": "camouflage_bp"
            },
            "Cake Backpack": {
                "value-option": "cake_bp"
            },
            "Crown Backpack": {
                "value-option": "crown_bp"
            },
            "Crystal Backpack": {
                "value-option": "crystal_bp"
            },
            "Demon Backpack": {
                "value-option": "demon_bp"
            },
            "Deepling Backpack": {
                "value-option": "deepling_bp"
            },
            "Dragon Backpack": {
                "value-option": "dragon_bp"
            },
            "Energetic Backpack": {
                "value-option": "energetic_bp"
            },
            "Expedition Backpack": {
                "value-option": "expedition_bp"
            },
            "Feedbag": {
                "value-option": "feedbag"
            },
            "Festive Backpack": {
                "value-option": "festive_bp"
            },
            "Fur Backpack": {
                "value-option": "fur_bp"
            },
            "Glooth Backpack": {
                "value-option": "glooth_bp"
            },
            "Heart Backpack": {
                "value-option": "heart_bp"
            },
            "Jewelled Backpack": {
                "value-option": "jewelled_bp"
            },
            "Minotaur Backpack": {
                "value-option": "minotaur_bp"
            },
            "Moon Backpack": {
                "value-option": "moon_bp"
            },
            "Mushroom Backpack": {
                "value-option": "mushroom_bp"
            },
            "Pannier Backpack": {
                "value-option": "pannier_bp"
            },
            "Pillow Backpack": {
                "value-option": "pillow_bp"
            },
            "Pirate Backpack": {
                "value-option": "pirate_bp"
            },
            "Santa Backpack": {
                "value-option": "santa_bp"
            },
            "Wolf Backpack": {
                "value-option": "wolf_bp"
            },
            "Old and Used Backpack": {
                "value-option": "old_and_used_bp"
            },
        },
        "bonus": {
            "Aumento de Capacidade/Capacity Increase": "capacity_increase"
        }
    },
    "boots": {
        "itens": {

        },
        "bonus": {
            "Aumento de Velocidade/Speed Increase": "speed_increase"
        }
    },
    "helmet": {
        "itens": {

        },
        "bonus": {
            "Roubo de mana/Mana Leech": "mana_leech", "Aumento/Upgrade Axe Fighting": "axe_upgrade", "Aumento/Upgrade Sword Fighting ": "sword_upgrade",
            "Aumento/Upgrade Club Fighting": "club_upgrade", "Aumento/Upgrade Distance Fighting": "distance_upgrade", "Aumento/Upgrade Shielding": "shield_upgrade",
            "Aumento/Upgrade Magic Level": "ml_upgrade"
        }
    },
    "club": {},
    "distance": {},
    "shield": {},
    "sword": {},
    "axe": {},
    "spellbook": {},
    "wandRod": {}
}


var current_item = {};
var imbue_type = "basic";

/*Função que verifica se está selecionada uma categoria válida, se sim chama a função para exibir os itens
da respectiva categoria.*/
function categoriaChange() {
    const categoria_select = document.getElementById("categoria_select");
    var item_select = document.getElementById("item_select");

    if (categoria_select.value != "none") {
        item_select.disabled = false;
        showOptionItens(categoria_select.value);
        showBonusImbue(categoria_select.value);
    }
    else {
        item_select.disabled = true;
        removeOptions(item_select);
        document.getElementById("itemImg").style = "background-image= none";
        removeAllElementsDiv(document.getElementById("divBonus"));
    }
}

function bonusRadioChange(imbueType) {
    var categoria = document.getElementById("categoria_select").value;
    imbue_type = imbueType;

    showBonusImbue(categoria);
}

function showBonusImbue(categoria) {
    var divBonus = document.getElementById("divBonus");
    var bonus = item_imbuing[categoria].bonus;

    removeAllElementsDiv(divBonus);

    for (var i in bonus) {
        var div_block = document.createElement("div");
        var div_inner_block = document.createElement("div");
        var p = document.createElement("p");

        var bonus_percent_value;
        switch (imbue_type) {
            case 'basic': {
                bonus_percent_value = bonus[i]["bonus-percent-value"][0];
                break;
            }
            case 'intricate': {
                bonus_percent_value = bonus[i]["bonus-percent-value"][1];
                break;
            }
            case 'powerful': {
                bonus_percent_value = bonus[i]["bonus-percent-value"][2];
                break;
            }
        }
        //adicionando texto do bonus
        p.textContent = bonus_percent_value + "% " + bonus[i]["bonus-msg"];
        //adicionando imagem
        div_inner_block.style.backgroundImage = bonus[i].image;
        //add divs e p
        div_block.appendChild(div_inner_block);
        div_block.appendChild(p);
        div_block.classList.toggle("block");
        div_block.title = bonus[i]["bonus-title"];
        divBonus.appendChild(div_block);
    }

}


//Função que adiciona os itens (no select), de acordo com a categoria
function showOptionItens(categoria) {
    var item_select = document.getElementById("item_select");

    removeOptions(item_select);

    //popula novamente o select de item
    var categoria_array = item_imbuing[categoria].itens;
    for (var key of Object.keys(categoria_array)) {
        var option = document.createElement("option");
        option.text = key;
        option.value = categoria_array[key]["value-option"];
        item_select.add(option);
    }

    changeItem();

}


function changeItem() {
    const categoria_select = document.getElementById("categoria_select");
    const item_select = document.getElementById("item_select");
    const opt_item_select = item_select.options[item_select.selectedIndex];
    const itemImg = document.getElementById("itemImg");
    current_item = item_imbuing[categoria_select.value].itens[opt_item_select.text];

    itemImg.style = "background-image: url(" + current_item.image + ")";
}


//remove as opções (<option></option>) de um select qualquer (<select></select>)
function removeOptions(selectbox) {
    var i;
    for (i = selectbox.options.length - 1; i >= 0; i--) {
        selectbox.remove(i);
    }
}

function removeAllElementsDiv(div) {
    while (div.firstChild) {
        div.removeChild(div.firstChild);
    }
}