const bonus_type = {
    "life_leech": {
        "name": "life_leech",
        "image": "",
        "bonus-msg-small": "% Life Leech",
        "bonus-title": "Roubo de vida",
        "imbue_type": {
            "basic": {
                "bonus-value": 5,
                "image": "https://www.tibiawiki.com.br/images/f/f1/Vampire_Teeth.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Vampire_Teeth",
                "title": "Vampire Teeth"

            },
            "intricate": {
                "bonus-value": 10,
                "image": "https://www.tibiawiki.com.br/images/1/1d/Bloody_Pincers.gif",
                "amount": "15",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Bloody_Pincers",
                "title": "Bloody Pincers"
            },
            "powerful": {
                "bonus-value": 25,
                "image": "https://www.tibiawiki.com.br/images/8/85/Piece_of_Dead_Brain.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Piece_of_Dead_Brain",
                "title": "Piece of Dead Brain"
            }
        }
    },
    "death_reduction": {
        "name": "death_reduction",
        "image": "https://tibiawiki.com.br/images/e/e6/Cursed_Flash_Icon.gif",
        "bonus-msg-small": "% Death reduction",
        "bonus-title": "Redução dano Death",
        "imbue_type": {
            "basic": {
                "bonus-value": 2,
                "image": "https://www.tibiawiki.com.br/images/c/c2/Flask_of_Embalming_Fluid.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Flask_of_Embalming_Fluid",
                "title": "Flask of Embalming Fluid"

            },
            "intricate": {
                "bonus-value": 5,
                "image": "https://www.tibiawiki.com.br/images/f/ff/Gloom_Wolf_Fur.gif",
                "amount": "20",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Gloom_Wolf_Fur",
                "title": "Gloom Wolf Fur"
            },
            "powerful": {
                "bonus-value": 10,
                "image": "https://www.tibiawiki.com.br/images/0/08/Mystical_Hourglass.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Mystical_Hourglass",
                "title": "Mystical Hourglass"
            },
        },
    },
    "earth_reduction": {
        "name": "earth_reduction",
        "image": "",
        "bonus-msg-small": "% Earth reduction",
        "bonus-title": "Redução dano Terra",
        "imbue_type": {
            "basic": {
                "bonus-value": 3,
                "image": "https://www.tibiawiki.com.br/images/f/f6/Piece_of_Swampling_Wood.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Piece_of_Swampling_Wood",
                "title": "Piece of Swampling Wood"

            },
            "intricate": {
                "bonus-value": 8,
                "image": "https://www.tibiawiki.com.br/images/3/3e/Snake_Skin.gif",
                "amount": "20",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Snake_Skin",
                "title": "Snake Skin"
            },
            "powerful": {
                "bonus-value": 15,
                "image": "https://www.tibiawiki.com.br/images/7/7a/Brimstone_Fangs.gif",
                "amount": "10",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Brimstone_Fangs",
                "title": "Brimstone Fangs"
            },
        },
    },
    "fire_reduction": {
        "name": "fire_reduction",
        "image": "https://www.tibiawiki.com.br/images/9/95/Burning_Flash_Icon.gif",
        "bonus-msg-small": "% Fire reduction",
        "bonus-title": "Redução dano Fogo",
        "imbue_type": {
            "basic": {
                "bonus-value": 3,
                "image": "https://www.tibiawiki.com.br/images/d/d9/Green_Dragon_Leather.gif",
                "amount": "20",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Green_Dragon_Leather",
                "title": "Green Dragon Leather"

            },
            "intricate": {
                "bonus-value": 8,
                "image": "https://www.tibiawiki.com.br/images/0/01/Blazing_Bone.gif",
                "amount": "10",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Blazing_Bone",
                "title": "Blazing Bone"
            },
            "powerful": {
                "bonus-value": 15,
                "image": "https://www.tibiawiki.com.br/images/5/51/Draken_Sulphur.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Draken_Sulphur",
                "title": "Draken Sulphur"
            },
        },
    },
    "ice_reduction": {
        "name": "ice_reduction",
        "image": "https://tibiawiki.com.br/images/7/7d/Freezing_Flash_Icon.gif",
        "bonus-msg-small": "% Ice reduction",
        "bonus-title": "Redução dano gelo",
        "imbue_type": {
            "basic": {
                "bonus-value": 3,
                "image": "https://www.tibiawiki.com.br/images/f/f1/Vampire_Teeth.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Vampire_Teeth",
                "title": "Vampire Teeth"

            },
            "intricate": {
                "bonus-value": 8,
                "image": "https://www.tibiawiki.com.br/images/1/1d/Bloody_Pincers.gif",
                "amount": "15",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Bloody_Pincers",
                "title": "Bloody Pincers"
            },
            "powerful": {
                "bonus-value": 15,
                "image": "https://www.tibiawiki.com.br/images/8/85/Piece_of_Dead_Brain.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Piece_of_Dead_Brain",
                "title": "Piece of Dead Brain"
            },
        },
    },
    "energy_reduction": {
        "name": "energy_reduction",
        "image": "https://www.tibiawiki.com.br/images/f/f4/Electrified_Flash_Icon.gif",
        "bonus-msg-small": "% Energy reduction",
        "bonus-title": "Redução dano energia",
        "imbue_type": {
            "basic": {
                "bonus-value": 3,
                "image": "https://www.tibiawiki.com.br/images/f/f1/Vampire_Teeth.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Vampire_Teeth",
                "title": "Vampire Teeth"

            },
            "intricate": {
                "bonus-value": 8,
                "image": "https://www.tibiawiki.com.br/images/1/1d/Bloody_Pincers.gif",
                "amount": "15",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Bloody_Pincers",
                "title": "Bloody Pincers"
            },
            "powerful": {
                "bonus-value": 15,
                "image": "https://www.tibiawiki.com.br/images/8/85/Piece_of_Dead_Brain.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Piece_of_Dead_Brain",
                "title": "Piece of Dead Brain"
            }
        },
    },
    "holy_reduction": {
        "name": "holy_reduction",
        "image": "https://www.tibiawiki.com.br/images/9/98/Dazzled_Flash_Icon.gif",
        "bonus-msg-small": "% Holy reduction",
        "bonus-title": "Redução dano sagrado",
        "imbue_type": {
            "basic": {
                "bonus-value": 3,
                "image": "https://www.tibiawiki.com.br/images/f/f1/Vampire_Teeth.gif",
                "amount": "25",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Vampire_Teeth",
                "title": "Vampire Teeth"

            },
            "intricate": {
                "bonus-value": 8,
                "image": "https://www.tibiawiki.com.br/images/1/1d/Bloody_Pincers.gif",
                "amount": "15",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Bloody_Pincers",
                "title": "Bloody Pincers"
            },
            "powerful": {
                "bonus-value": 15,
                "image": "https://www.tibiawiki.com.br/images/8/85/Piece_of_Dead_Brain.gif",
                "amount": "5",
                "link-tibiaWiki": "https://www.tibiawiki.com.br/wiki/Piece_of_Dead_Brain",
                "title": "Piece of Dead Brain"
            }
        },
    },
}
const bonus_group_armor = [
    bonus_type.life_leech,
    bonus_type.death_reduction,
    bonus_type.fire_reduction,
    bonus_type.ice_reduction,
    bonus_type.energy_reduction,
    bonus_type.holy_reduction
]

const item_imbuing = {
    "armor": {
        "Albino Plate": {
            "value-option": "albino_plate",
            "image": "https://www.tibiawiki.com.br/images/9/98/Albino_Plate.gif",
            "bonus": bonus_group_armor,
        },
        "Amazon Armor": {
            "value-option": "amazon_armor",
            "image": "https://www.tibiawiki.com.br/wiki/Especial:Redirecionar/file/Amazon_Armor.gif",
            "bonus": bonus_group_armor,
        },
        "Blue Robe": {
            "value-option": "blue_robe",
            "image": "",
            "bonus": bonus_group_armor,
        },
        "Chain Armor": {
            "value-option": "chain_armor",
            "image": "",
            "bonus": bonus_group_armor,
        },
        "Crown Armor": {
            "value-option": "crown_armor",
            "bonus": bonus_group_armor,
        },
        "Demon Armor": {
            "value-option": "demon_armor",
            "bonus": bonus_group_armor,
        },
        "Depth Lorica": {
            "value-option": "depth_lorica",
        },
        "Dragon Scale Mail": {
            "value-option": "dragon_scale_mail"
        },
        "Dream Shroud": {
            "value-option": "dream_shroud"
        },
        "Dwarven Armor": {
            "value-option": "dwarven_armor"
        },
        "Elite Draken Mail": {
            "value-option": "elite_draken_mail"
        },
        "Elven Mail": {
            "value-option": "elven_mail"
        },
        "Falcon Plate": {
            "value-option": "falcon_plate"
        },
        "Gnome Armor": {
            "value-option": "gnome_armor"
        },
        "Golden Amor": {
            "value-option": "golden_armor"
        },
        "Heat Core": {
            "value-option": "heat_core"
        },
        "Heavy Metal T-Shirt": {
            "value-option": "heavy_metal_t-shirt"
        },
        "Knight Armor": {
            "value-option": "knight_armor"
        },
        "Leopard Armor": {
            "value-option": "leopard_armor"
        },
        "Living Armor": {
            "value-option": "living_armor"
        },
        "Magic Plate Armor": {
            "value-option": "magic_plate_armor"
        },
        "Mammoth Fur Cape": {
            "value-option": "mammoth_fur_cape"
        },
        "Master Archer's Armor": {
            "value-option": "master_archers_armor"
        },
        "Mooh'tah Plate": {
            "value-option": "moohtah_plate"
        },
        "Noble Armor": {
            "value-option": "noble_armor"
        },
        "Ornate Chestplate": {
            "value-option": "ornate_chestplate"
        },
        "Paladin Armor": {
            "value-option": "paladin_armor"
        },
        "Prismatic Armor": {
            "value-option": "prismatic_armor"
        },
    },
    "backpack": {
        "itens": {
            "Anniversary Backpack": {
                "value-option": "anniversary_bp"
            },
            "Backpack": {
                "value-option": "bp"
            },
            "Backpack of Holding": {
                "value-option": "backpack_of_holding"
            },
            "Beach Backpack": {
                "value-option": "beach_bp"
            },
            "Birthday Backpack": {
                "value-option": "birthday_bp"
            },
            "Buggy Backpack": {
                "value-option": "buggy_bp"
            },
            "Book Backpack": {
                "value-option": "buggy_bp"
            },
            "Brocade Backpack": {
                "value-option": "brocade_bp"
            },
            "Camouflage Backpack": {
                "value-option": "camouflage_bp"
            },
            "Cake Backpack": {
                "value-option": "cake_bp"
            },
            "Crown Backpack": {
                "value-option": "crown_bp"
            },
            "Crystal Backpack": {
                "value-option": "crystal_bp"
            },
            "Demon Backpack": {
                "value-option": "demon_bp"
            },
            "Deepling Backpack": {
                "value-option": "deepling_bp"
            },
            "Dragon Backpack": {
                "value-option": "dragon_bp"
            },
            "Energetic Backpack": {
                "value-option": "energetic_bp"
            },
            "Expedition Backpack": {
                "value-option": "expedition_bp"
            },
            "Feedbag": {
                "value-option": "feedbag"
            },
            "Festive Backpack": {
                "value-option": "festive_bp"
            },
            "Fur Backpack": {
                "value-option": "fur_bp"
            },
            "Glooth Backpack": {
                "value-option": "glooth_bp"
            },
            "Heart Backpack": {
                "value-option": "heart_bp"
            },
            "Jewelled Backpack": {
                "value-option": "jewelled_bp"
            },
            "Minotaur Backpack": {
                "value-option": "minotaur_bp"
            },
            "Moon Backpack": {
                "value-option": "moon_bp"
            },
            "Mushroom Backpack": {
                "value-option": "mushroom_bp"
            },
            "Pannier Backpack": {
                "value-option": "pannier_bp"
            },
            "Pillow Backpack": {
                "value-option": "pillow_bp"
            },
            "Pirate Backpack": {
                "value-option": "pirate_bp"
            },
            "Santa Backpack": {
                "value-option": "santa_bp"
            },
            "Wolf Backpack": {
                "value-option": "wolf_bp"
            },
            "Old and Used Backpack": {
                "value-option": "old_and_used_bp"
            },
        },
        "bonus": [

        ]
    },
    "boots": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "helmet": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "club": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "distance": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "shield": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "sword": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "axe": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "spellbook": {
        "itens": {

        },
        "bonus": [

        ]
    },
    "wandRod": {
        "itens": {

        },
        "bonus": [

        ]
    }
}



var current_item = {
    "categoria": "none",
    "itemProp": "",
    "imbueType": "basic",
    "protectionMoney": 10000,
    "imbuePrice": 5000,
    "totalMoney": 15000,
    "bonusSelected": "none",
};

/*Função que verifica se está selecionada uma categoria válida, se sim chama a função para exibir os itens
da respectiva categoria.*/
function categoriaChange() {
    const categoria_select = document.getElementById("categoria_select");
    var item_select = document.getElementById("item_select");
    current_item.categoria = categoria_select.value;

    if (current_item.categoria != "none") {
        item_select.disabled = false;
        showOptionItens();
    }
    else {
        item_select.disabled = true;
        removeOptions(item_select);
        document.getElementById("itemImg").style = "background-image= none";
        current_item.itemProp = "";
        removeAllElementsDiv(document.getElementById("divBonus"));
    }
}

//Função que adiciona os itens (no select), de acordo com a categoria
function showOptionItens() {
    var item_select = document.getElementById("item_select");

    removeOptions(item_select);

    //popula novamente o select de item
    var itens_categoria = item_imbuing[current_item.categoria];
    for (var key of Object.keys(itens_categoria)) {
        var option = document.createElement("option");
        option.text = key;
        option.value = itens_categoria[key]["value-option"];
        item_select.add(option);
    }
    changeItem();
}


function changeItem() {
    const item_select = document.getElementById("item_select");
    const opt_item_select = item_select.options[item_select.selectedIndex];
    const itemImg = document.getElementById("itemImg");
    current_item.itemProp = item_imbuing[current_item.categoria][opt_item_select.text];

    itemImg.style.backgroundImage = "url(" + current_item.itemProp.image + ")";

    showBonusImbue();
}

function bonusRadioChange(imbueValue) {
    current_item.imbueType = imbueValue;

    switch (current_item.imbueType) {
        case 'basic': {
            current_item.protectionMoney = 10000;
            current_item.imbuePrice = 5000;
            current_item.totalMoney = current_item.protectionMoney + current_item.imbuePrice;
            break;
        }
        case 'intricate': {
            current_item.protectionMoney = 30000;
            current_item.imbuePrice = 25000;
            current_item.totalMoney = current_item.protectionMoney + current_item.imbuePrice;
            break;
        }
        case 'powerful': {
            current_item.protectionMoney = 50000;
            current_item.imbuePrice = 100000;
            current_item.totalMoney = current_item.protectionMoney + current_item.imbuePrice;
            break;
        }

    }
    document.getElementById("protectMoney").textContent = current_item.protectionMoney;
    document.getElementById("totalMoney").textContent = current_item.imbuePrice;

    document.getElementById("item1").style.backgroundImage = "none";
    document.getElementById("item2").style.backgroundImage = "none";
    document.getElementById("item3").style.backgroundImage = "none";
    document.getElementById("quant_item1").textContent = "0";
    document.getElementById("quant_item2").textContent = "0";
    document.getElementById("quant_item3").textContent = "0";

    showBonusImbue();
}

function showBonusImbue() {
    var divBonus = document.getElementById("divBonus");
    var bonus = current_item.itemProp.bonus;

    removeAllElementsDiv(divBonus);

    for (var i in bonus) {
        var div_block = document.createElement("div");
        var div_inner_block = document.createElement("div");
        var p = document.createElement("p");

        //adicionando texto do bonus
        p.textContent = bonus[i].imbue_type[current_item.imbueType]["bonus-value"] + bonus[i]["bonus-msg-small"];
        //adicionando imagem
        div_inner_block.style.backgroundImage = "url(" + bonus[i].image + ")";
        //add divs e p
        div_block.onclick = function () { bonus_selected(this) }
        div_block.dataset.type = bonus[i].name;
        div_block.appendChild(div_inner_block);
        div_block.appendChild(p);
        div_block.classList.add("block");
        div_block.title = bonus[i]["bonus-title"];
        divBonus.appendChild(div_block);
    }

}

function bonus_selected(element) {
    var chieldrens = document.getElementsByClassName("selected");
    Array.prototype.slice.call(chieldrens).forEach(function (element) {
        element.classList.remove("selected");
    });
    element.classList.add("selected");
    current_item.bonusSelected = bonus_type[element.dataset.type];
    showItensForImbue();

}

function showItensForImbue() {
    //itens necessarios para imbuir
    var itemForImbue1 = document.getElementById("item1");
    var itemForImbue2 = document.getElementById("item2");
    var itemForImbue3 = document.getElementById("item3");
    //quantidade dos items
    var quantItemForImbue1 = document.getElementById("quant_item1");
    var quantItemForImbue2 = document.getElementById("quant_item2");
    var quantItemForImbue3 = document.getElementById("quant_item3");

    switch (current_item.imbueType) {
        case 'basic': {
            itemForImbue1.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.basic.image + ")";
            quantItemForImbue1.textContent = current_item.bonusSelected.imbue_type.basic.amount;
            itemForImbue2.style.backgroundImage = "none";
            quantItemForImbue2.textContent = "0";
            itemForImbue3.style.backgroundImage = "none";
            quantItemForImbue3.textContent = "0";
            break;
        }
        case 'intricate': {
            itemForImbue1.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.basic.image + ")";
            quantItemForImbue1.textContent = current_item.bonusSelected.imbue_type.basic.amount;
            itemForImbue2.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.intricate.image + ")";
            quantItemForImbue2.textContent = current_item.bonusSelected.imbue_type.intricate.amount;
            itemForImbue3.style.backgroundImage = "none";
            quantItemForImbue3.textContent = "0";
            break;
        }
        case 'powerful': {
            itemForImbue1.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.basic.image + ")";
            quantItemForImbue1.textContent = current_item.bonusSelected.imbue_type.basic.amount;
            itemForImbue2.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.intricate.image + ")";
            quantItemForImbue2.textContent = current_item.bonusSelected.imbue_type.intricate.amount;
            itemForImbue3.style.backgroundImage = "url(" + current_item.bonusSelected.imbue_type.powerful.image + ")";
            quantItemForImbue3.textContent = current_item.bonusSelected.imbue_type.powerful.amount;
            break;
        }
    }
}

//remove as opções (<option></option>) de um select qualquer (<select></select>)
function removeOptions(selectbox) {
    var i;
    for (i = selectbox.options.length - 1; i >= 0; i--) {
        selectbox.remove(i);
    }
}

function removeAllElementsDiv(div) {
    while (div.firstChild) {
        div.removeChild(div.firstChild);
    }
}